# 🎞️ ShopManager - 영화 굿즈 관리 프로그램
2023.11.22 - 2023.12.04 (2주)

### 팀 구성 및 역할
- **정지석**: 전체 UI 디자인, 전체 UI 구현, 홈 화면, RecyclerView 구현, 로그인 화면 기능 구현
- **김성한**: 초기 데이터 수집 및 구축, 영화 API 연동
- **박상원**: 정산 페이지 구성, 이미지 파일 입출력 구현, RoomDB 구축

---
일정 수립 및 문서화는 Figma를 이용하였습니다.
> https://www.figma.com/design/76ct7AROMUCHrdTMtLwiI5/%EC%87%BC%ED%95%91%EC%95%B1-%EC%8B%A4%EC%8A%B5?node-id=1-3699&t=DksZT39deQYcSrCI-1

## 📑 소개
ShopManager는 **영화 굿즈 상품 관리**를 위한 안드로이드 애플리케이션입니다.  
GitHub를 통한 **팀 협업 경험**과 실제 **프로젝트 개발 경험**을 쌓는 것을 목표로 진행했습니다.  

## 🎯 평가 기준 충족 내용
1. **물건 관리 기능**
   - 상품 등록, 수정, 삭제 기능 구현
   - 다중 이미지 등록 및 관리 시스템 구현
   - 상품 검색 및 카테고리별 필터링 기능

2. **이미지 파일 입출력**
   - 내부 저장소를 활용한 이미지 파일 관리
   - URI 기반 이미지 저장 및 로딩 시스템
   - 이미지 캐싱 및 메모리 관리

3. **RoomDatabase 사용**
   - Room 엔티티 및 DAO 설계
   - TypeConverter를 통한 복잡한 데이터 타입 처리
   - 비동기 데이터 처리를 위한 Coroutine 활용

4. **화면 구성**
   - BottomNavigationView를 통한 메인 내비게이션
   - Fragment 기반 화면 전환 시스템

5. **추가 기능 구현**
   - 영화 API 연동
   - 매출 관리 시스템
   - 계정 관리 기능

## ✨ 주요 기능
1. 상품 관리
   - 상품 목록 표시
   - 카테고리별 필터링 (디즈니, 픽사, 마블, 해리포터, 지브리, 티니핑)
   - 상품 검색
   - 상품 상세 정보 조회
   - 상품 등록/수정/삭제

2. 매출 관리 - 화면만 구성성
   - 베스트 상품 TOP 5 표시
   - 로그인 사용자 전용 기능

3. 계정 관리
   - 회원가입/로그인
   - 계정 정보 수정
   - 로그아웃 및 회원 탈퇴

## 🔥 구현 내용 및 해결 과제
1. Room Database 구현
   - 엔티티 및 DAO 설계
   - TypeConverter를 통한 리스트 타입 변환
   - 초기 데이터 삽입 로직 구현

2. 이미지 처리
   - URI를 통한 이미지 파일 저장
   - 내부 저장소 활용
   - 비동기 이미지 로딩

3. Fragment 관리
   - Fragment 전환 애니메이션
   - BottomNavigationView 연동
   - 프래그먼트 백스택 관리

4. 계정 관리 시스템
   - SharedPreferences를 활용한 로그인 상태 관리
   - 계정 정보 암호화 저장
   - 자동 로그인 구현

5. 확장 함수를 통한 코드 최적화
   - Fragment 전환 확장 함수
   - 이미지 로딩 확장 함수
   - SharedPreferences 접근 확장 함수
   - UI 유틸리티 확장 함수

## 📁 패키지 구조
```
com.lion.five.shopmanager/
├── adapter/
├── data/
│   ├── converter/
│   ├── dao/
│   ├── model/
│   └── vo/
├── fragment/
└── utils/
```

각 화면은 Fragment로 구현하여 fragment 패키지에서 관리하고,  
데이터 관련 클래스들은 data 패키지 아래에서 관리했습니다.

재사용 가능한 유틸리티성 코드와 확장 함수들은 utils 패키지에 모아서 관리함으로써,  
작은 규모의 프로젝트임에도 코드의 역할과 책임을 명확히 분리했습니다.

## 🚧 주요 문제 및 해결 과정
### 1. 상품 수정 시 MovieName 초기화 문제
**문제 상황**
- 상품 정보 수정 시 MovieName enum이 UNKNOWN으로 초기화되는 현상 발생
- 이로 인해 영화 API 요청 실패 및 잘못된 데이터 저장 발생

**해결 방법**
- MovieName enum 대신 String으로 직접 영화 제목 저장하도록 수정
- 영화 API 요청 시 저장된 영화 제목을 직접 사용
- 데이터 일관성 검증 로직 추가

### 2. 초기 데이터 로딩 시간 이슈
**문제**
- 초기 데이터(이미지) 저장 시간이 MainActivity 실행 시간보다 느림
- 이로 인해 저장되지 않은 이미지를 불러오려고 시도하면서 앱 크래시 발생

**해결 방법**
- SplashActivity를 추가하여 초기 데이터 저장 완료 시점까지 대기
- 코루틴을 사용하여 500ms 간격으로 데이터 저장 완료 여부 확인
- 데이터 저장이 완료된 후에만 MainActivity로 전환

### 3. 이미지 로딩 중 RecyclerView 아이템 재사용 문제
**문제**
- RecyclerView 스크롤 시 잘못된 이미지가 표시되는 현상 발생
- ViewHolder 재사용으로 인한 이미지 매칭 오류

**해결 방법**
- ImageView에 태그를 설정하여 현재 로딩 중인 이미지 식별
- 이미지 로딩 완료 시점에 태그를 확인하여 뷰가 재사용되었는지 검증
- 태그가 일치하는 경우에만 이미지 설정

### 4. 카테고리 필터링 시 화면 깜빡임 현상
**문제**
- 칩 선택 시마다 전체 리스트가 새로 로드되면서 화면 깜빡임 발생
- 불필요한 아이템 갱신으로 인한 성능 저하

**해결 방법**
- ListAdapter와 DiffUtil을 사용하여 변경된 아이템만 효율적으로 업데이트
- 백그라운드 스레드에서 필터링 작업 수행
- DiffUtil을 통해 실제 변경된 아이템만 업데이트하여 불필요한 깜빡임 방지

## 🛠 사용 기술
### Android
- Kotlin
- Fragment
- ViewBinding
- Room Database
- Coroutines
- SharedPreferences
- Kotlin Extension Functions
- Retrofit2

### Storage
- Room Database (로컬 데이터베이스)
- File System (이미지 저장)
- SharedPreferences (계정 관리)

### 협업 도구
- Git/GitHub
- Figma (UI/UX 설계 및 팀 문서화)

## 🎦 영화 API 활용
### 구현 내용
1. **영화 정보 연동**
   - 한국영화진흥위원회 오픈 API 활용
   - Retrofit2를 사용한 네트워크 통신
   - 코루틴을 활용한 비동기 처리

2. **데이터 처리**
   - 영화 제목 기반 검색 기능
   - 감독, 개봉일, 장르 정보 표시
   - 응답 데이터 파싱 및 UI 업데이트
   - 응답 대기 중에 프로그레스바 표시

3. **에러 처리**
   - 네트워크 오류 대응
   - API 응답 실패 처리

## 💡 배운 점
1. 로컬 데이터베이스
   - Room Database 설계
   - DAO 작성 및 쿼리 최적화

2. UI/UX 개발
   - RecyclerView 성능 최적화
   - 커스텀 애니메이션 구현

3. 파일 처리
   - 안드로이드 저장소 시스템
   - 이미지 파일 처리
   - URI 처리 방법

4. 코드 최적화
   - 확장 함수를 통한 코드 재사용성 향상
   - 중복 코드 제거
   - 팀 협업 효율성 증가

5. 협업 프로세스
   - Git/GitHub 활용법
   - 브랜치 전략 수립
